<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ app_settings.app_name if app_settings else 'YTDL Web API' }} - Documentação</title>
    {% if app_settings and app_settings.favicon_url %}
    <link rel="icon" type="image/x-icon" href="{{ app_settings.favicon_url }}">
    {% endif %}
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/docs.css') }}">
    
    {% if app_settings %}
    <style>
        :root {
            --primary-color: {{ app_settings.primary_color or '#0891b2' }};
            --secondary-color: {{ app_settings.secondary_color or '#0e7490' }};
        }
    </style>
    {% endif %}
</head>
<body class="bg-gray-900 text-gray-200 gradient-bg">
    
    <!-- Background Elements -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-cyan-500/10 rounded-full blur-3xl floating-animation"></div>
        <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl floating-animation" style="animation-delay: -3s;"></div>
    </div>

    <!-- Navigation -->
    <nav class="glass-effect sticky top-0 z-50 border-b border-gray-700/50">
        <div class="container mx-auto px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-cyan-600 to-cyan-700 rounded-lg flex items-center justify-center">
                            {% if app_settings and app_settings.app_logo %}
                                <img src="{{ app_settings.app_logo }}" alt="Logo" class="w-8 h-8 rounded">
                            {% else %}
                                <i class="fas fa-download text-white"></i>
                            {% endif %}
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-white">{{ app_settings.app_name if app_settings else 'YTDL Web API' }}</h1>
                            <p class="text-xs text-gray-400">Documentação v2.0</p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="/api/health" class="text-gray-400 hover:text-cyan-400 transition-colors">
                        <i class="fas fa-heartbeat mr-1"></i>Status
                    </a>
                    <a href="{{ url_for('auth.login') }}" class="bg-gradient-to-r from-cyan-600 to-cyan-700 hover:from-cyan-700 hover:to-cyan-800 text-white font-semibold py-2 px-4 rounded-lg transition-all transform hover:scale-105">
                        <i class="fas fa-cog mr-2"></i>Painel Admin
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-8 py-8">
        <div class="flex gap-8">
            <!-- Sidebar -->
            <aside class="w-64 glass-effect rounded-xl p-6 h-fit sticky top-24">
                <h3 class="text-lg font-semibold text-cyan-300 mb-4">
                    <i class="fas fa-list mr-2"></i>Navegação
                </h3>
                <nav class="space-y-2">
                    <a href="#overview" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-home w-5 mr-3"></i>Visão Geral
                    </a>
                    <a href="#try-now" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-play w-5 mr-3"></i>Testar Agora
                    </a>
                    <a href="#authentication" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-key w-5 mr-3"></i>Autenticação
                    </a>
                    <a href="#endpoints" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-plug w-5 mr-3"></i>Endpoints
                    </a>
                    <a href="#examples" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-code w-5 mr-3"></i>Exemplos
                    </a>
                    <a href="#supported-sites" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-globe w-5 mr-3"></i>Sites Suportados
                    </a>
                    <a href="#errors" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-exclamation-triangle w-5 mr-3"></i>Códigos de Erro
                    </a>
                    <a href="#sdks" class="nav-link flex items-center p-3 rounded-lg text-gray-300">
                        <i class="fas fa-cube w-5 mr-3"></i>SDKs & Bibliotecas
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 space-y-8">
                
                <!-- Overview Section -->
                <section id="overview" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <div class="text-center mb-8">
                            <h2 class="text-4xl font-bold text-white mb-4">API de Download de Mídia</h2>
                            <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                                Uma API REST poderosa e moderna para download de vídeos e áudios de mais de 1000 sites, 
                                com processamento assíncrono, acompanhamento em tempo real e autenticação por chave de API.
                            </p>
                        </div>

                        <div class="grid md:grid-cols-3 gap-6 mb-8">
                            <div class="feature-card">
                                <i class="fas fa-rocket text-3xl text-green-400 mb-3"></i>
                                <h3 class="text-lg font-semibold text-white mb-2">Rápida & Eficiente</h3>
                                <p class="text-sm text-gray-400">Processamento assíncrono com Celery para downloads rápidos</p>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-shield-alt text-3xl text-blue-400 mb-3"></i>
                                <h3 class="text-lg font-semibold text-white mb-2">Segura</h3>
                                <p class="text-sm text-gray-400">Autenticação por API Key e rate limiting por IP</p>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-cogs text-3xl text-purple-400 mb-3"></i>
                                <h3 class="text-lg font-semibold text-white mb-2">Flexível</h3>
                                <p class="text-sm text-gray-400">Suporte a múltiplos formatos, qualidades e playlists</p>
                            </div>
                        </div>

                        <div class="bg-gray-800/50 rounded-lg p-6 border border-gray-700">
                            <h3 class="text-xl font-semibold text-cyan-300 mb-4">
                                <i class="fas fa-info-circle mr-2"></i>Características Principais
                            </h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <ul class="space-y-2 text-gray-300">
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Download de vídeos em MP4</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Extração de áudio em MP3</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Qualidade personalizável</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Processamento de playlists</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Download em lote</li>
                                </ul>
                                <ul class="space-y-2 text-gray-300">
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Rate limiting configurável</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Acompanhamento em tempo real</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Suporte a cookies</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Painel administrativo</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Mais de 1000 sites suportados</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Try Now Section -->
                <section id="try-now" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-play mr-3 text-cyan-400"></i>Testar Agora
                        </h2>
                        
                        <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4 mb-6">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-info-circle text-yellow-400 mr-2"></i>
                                <span class="font-semibold text-yellow-300">Teste Gratuito</span>
                            </div>
                            <p class="text-gray-300">Você pode testar a API gratuitamente com limite de <span class="text-cyan-400 font-semibold">{{ public_download_limit or 5 }} downloads por IP por hora</span>.</p>
                        </div>

                        <div class="grid lg:grid-cols-2 gap-8">
                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">
                                    <i class="fas fa-download mr-2"></i>Download Gratuito
                                </h3>
                                <form id="public-download-form" class="space-y-4">
                                    <div>
                                        <label for="public-url" class="block text-sm font-medium text-gray-400 mb-2">URL do Vídeo</label>
                                        <input type="url" id="public-url" placeholder="https://www.youtube.com/watch?v=..." required 
                                               class="w-full bg-gray-700/50 border border-gray-600 rounded-lg py-3 px-4 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all">
                                    </div>
                                    <div>
                                        <label for="public-type" class="block text-sm font-medium text-gray-400 mb-2">Tipo</label>
                                        <select id="public-type" class="w-full bg-gray-700/50 border border-gray-600 rounded-lg py-3 px-4 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                            <option value="audio">Áudio (MP3)</option>
                                            <option value="video">Vídeo (MP4)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="public-quality" class="block text-sm font-medium text-gray-400 mb-2">Qualidade</label>
                                        <select id="public-quality" class="w-full bg-gray-700/50 border border-gray-600 rounded-lg py-3 px-4 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                            <option value="">Melhor qualidade disponível</option>
                                            <option value="1080p">Full HD (1080p)</option>
                                            <option value="720p">HD (720p)</option>
                                            <option value="480p">SD (480p)</option>
                                            <option value="360p">360p</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="w-full py-3 px-4 rounded-lg text-white font-semibold bg-gradient-to-r from-cyan-600 to-cyan-700 hover:from-cyan-700 hover:to-cyan-800 flex items-center justify-center space-x-2 transition-all">
                                        <i class="fas fa-download"></i>
                                        <span>Baixar Agora</span>
                                    </button>
                                </form>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">
                                    <i class="fas fa-terminal mr-2"></i>Log do Download
                                </h3>
                                <div id="public-download-log" class="bg-gray-900 rounded-lg p-4 h-80 overflow-y-auto font-mono text-sm border border-gray-700">
                                    <p class="text-gray-500">Aguardando download...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Authentication Section -->
                <section id="authentication" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-key mr-3 text-cyan-400"></i>Autenticação
                        </h2>
                        
                        <div class="space-y-6">
                            <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-4">
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-info-circle text-blue-400 mr-2"></i>
                                    <span class="font-semibold text-blue-300">API Key Necessária</span>
                                </div>
                                <p class="text-gray-300">Para uso programático da API, você precisa de uma chave de API válida no header <code class="bg-gray-700 px-2 py-1 rounded text-cyan-300">X-API-Key</code>.</p>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">Como obter uma API Key</h3>
                                <ol class="list-decimal list-inside space-y-2 text-gray-300 ml-4">
                                    <li>Acesse o <a href="{{ url_for('auth.login') }}" class="text-cyan-400 hover:underline">painel administrativo</a></li>
                                    <li>Faça login com suas credenciais</li>
                                    <li>Navegue até a seção "Configurações" → "Chaves de API"</li>
                                    <li>Clique em "Gerar Nova Chave"</li>
                                    <li>Copie e guarde sua chave em local seguro</li>
                                </ol>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">Exemplo de Uso</h3>
                                <div class="code-block">
                                    <pre><code class="language-bash">curl -X GET "{{ request.url_root }}api/media?type=audio&url=https://youtube.com/watch?v=example" \
  -H "X-API-Key: sua-chave-aqui" \
  -H "Content-Type: application/json"</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Endpoints Section -->
                <section id="endpoints" class="section">
                    <div class="space-y-6">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-plug mr-3 text-cyan-400"></i>Endpoints da API
                        </h2>

                        <!-- Media Download Endpoint -->
                        <div class="glass-effect rounded-xl p-8 endpoint-card">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-2xl font-bold text-white">Download de Mídia</h3>
                                <div class="flex items-center space-x-2">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="bg-gray-700 px-3 py-1 rounded text-cyan-300">/api/media</code>
                                </div>
                            </div>
                            
                            <p class="text-gray-400 mb-6">Inicia o processo de download de mídia a partir de uma URL de vídeo. Suporta vídeos individuais, playlists e download em lote.</p>
                            
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div>
                                    <h4 class="text-lg font-semibold text-cyan-300 mb-4">Parâmetros (Query String)</h4>
                                    <div class="space-y-3">
                                        <div class="parameter-card">
                                            <div class="flex items-center justify-between mb-2">
                                                <code class="text-cyan-300">type</code>
                                                <span class="text-xs bg-red-600 text-white px-2 py-1 rounded">obrigatório</span>
                                            </div>
                                            <p class="text-sm text-gray-400">Tipo de mídia: <code>'audio'</code> ou <code>'video'</code></p>
                                        </div>
                                        <div class="parameter-card">
                                            <div class="flex items-center justify-between mb-2">
                                                <code class="text-cyan-300">url</code>
                                                <span class="text-xs bg-red-600 text-white px-2 py-1 rounded">obrigatório</span>
                                            </div>
                                            <p class="text-sm text-gray-400">URL do vídeo, playlist ou canal para download</p>
                                        </div>
                                        <div class="parameter-card">
                                            <div class="flex items-center justify-between mb-2">
                                                <code class="text-cyan-300">quality</code>
                                                <span class="text-xs bg-gray-600 text-white px-2 py-1 rounded">opcional</span>
                                            </div>
                                            <p class="text-sm text-gray-400">Qualidade do vídeo: '2160p', '1440p', '1080p', '720p', '480p', '360p', '240p'</p>
                                        </div>
                                        <div class="parameter-card">
                                            <div class="flex items-center justify-between mb-2">
                                                <code class="text-cyan-300">bitrate</code>
                                                <span class="text-xs bg-gray-600 text-white px-2 py-1 rounded">opcional</span>
                                            </div>
                                            <p class="text-sm text-gray-400">Bitrate do áudio: '320k', '256k', '192k', '128k', '96k', '64k'</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 class="text-lg font-semibold text-cyan-300 mb-4">Respostas</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex items-center space-x-2 mb-2">
                                                <span class="status-badge status-200">200 OK</span>
                                                <span class="text-sm text-gray-400">Processamento concluído (vídeo individual)</span>
                                            </div>
                                            <div class="code-block">
                                                <pre><code class="language-json">{
  "status": {
    "task": "completed",
    "download_url": "{{ request.url_root }}api/download/file.mp3"
  },
  "metadata": {
    "title": "Título do Vídeo",
    "uploader": "Nome do Canal",
    "duration_string": "3:45"
  }
}</code></pre>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <div class="flex items-center space-x-2 mb-2">
                                                <span class="status-badge status-202">202 Accepted</span>
                                                <span class="text-sm text-gray-400">Processamento em andamento (playlist/lote)</span>
                                            </div>
                                            <div class="code-block">
                                                <pre><code class="language-json">{
  "status": "processing",
  "task_id": "abc123-def456",
  "check_status_url": "/api/tasks/abc123-def456",
  "type": "playlist"
}</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Other Endpoints Grid -->
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="text-sm text-cyan-300">/api/tasks/{id}</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Status da Tarefa</h3>
                                <p class="text-sm text-gray-400 mb-4">Verifica o status de uma tarefa em processamento com progresso detalhado.</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-key mr-1"></i>Requer API Key
                                </div>
                            </div>

                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="text-sm text-cyan-300">/api/download/{file}</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Download de Arquivo</h3>
                                <p class="text-sm text-gray-400 mb-4">Baixa o arquivo processado. Endpoint público sem autenticação.</p>
                                <div class="flex items-center text-xs text-green-500">
                                    <i class="fas fa-globe mr-1"></i>Público
                                </div>
                            </div>

                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="text-sm text-cyan-300">/api/health</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Health Check</h3>
                                <p class="text-sm text-gray-400 mb-4">Verifica a saúde da API e suas dependências (Redis, Database, Cookies).</p>
                                <div class="flex items-center text-xs text-green-500">
                                    <i class="fas fa-globe mr-1"></i>Público
                                </div>
                            </div>

                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="text-sm text-cyan-300">/api/public/media</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Download Público</h3>
                                <p class="text-sm text-gray-400 mb-4">Download gratuito com rate limiting por IP. Ideal para testes.</p>
                                <div class="flex items-center text-xs text-blue-500">
                                    <i class="fas fa-clock mr-1"></i>Rate Limited
                                </div>
                            </div>

                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-post">POST</span>
                                    <code class="text-sm text-cyan-300">/api/batch</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Download em Lote</h3>
                                <p class="text-sm text-gray-400 mb-4">Processa múltiplas URLs simultaneamente com acompanhamento detalhado.</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-key mr-1"></i>Requer API Key
                                </div>
                            </div>

                            <div class="endpoint-summary-card">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="method-badge method-get">GET</span>
                                    <code class="text-sm text-cyan-300">/api/supported-sites</code>
                                </div>
                                <h3 class="text-lg font-semibold text-white mb-2">Sites Suportados</h3>
                                <p class="text-sm text-gray-400 mb-4">Lista completa de todos os sites suportados pela API.</p>
                                <div class="flex items-center text-xs text-green-500">
                                    <i class="fas fa-globe mr-1"></i>Público
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Examples Section -->
                <section id="examples" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-code mr-3 text-cyan-400"></i>Exemplos de Uso
                        </h2>
                        
                        <div class="space-y-8">
                            <!-- cURL Examples -->
                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">cURL</h3>
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="text-lg font-medium text-white mb-2">Download de Áudio</h4>
                                        <div class="code-block">
                                            <pre><code class="language-bash">curl -X GET "{{ request.url_root }}api/media?type=audio&url=https://youtube.com/watch?v=dQw4w9WgXcQ&bitrate=320k" \
  -H "X-API-Key: sua-chave-aqui"</code></pre>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="text-lg font-medium text-white mb-2">Download de Playlist</h4>
                                        <div class="code-block">
                                            <pre><code class="language-bash">curl -X GET "{{ request.url_root }}api/media?type=video&url=https://youtube.com/playlist?list=PLExample&quality=1080p" \
  -H "X-API-Key: sua-chave-aqui"</code></pre>
                                        </div>
                                    </div>

                                    <div>
                                        <h4 class="text-lg font-medium text-white mb-2">Verificar Status da Tarefa</h4>
                                        <div class="code-block">
                                            <pre><code class="language-bash">curl -X GET "{{ request.url_root }}api/tasks/abc123-def456" \
  -H "X-API-Key: sua-chave-aqui"</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- JavaScript Examples -->
                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">JavaScript (Fetch API)</h3>
                                <div class="code-block">
                                    <pre><code class="language-javascript">const downloadMedia = async (url, type, options = {}) => {
  const params = new URLSearchParams({
    type,
    url,
    ...options
  });

  const response = await fetch(`{{ request.url_root }}api/media?${params}`, {
    headers: {
      'X-API-Key': 'sua-chave-aqui'
    }
  });

  const data = await response.json();
  
  if (data.status === 'completed' || data.status?.task === 'completed') {
    console.log('Download concluído:', data.status?.download_url || data.result?.download_url);
  } else if (data.status === 'processing') {
    console.log('Processando... ID da tarefa:', data.task_id);
    // Verificar status periodicamente
    await checkTaskStatus(data.task_id);
  }
};

const checkTaskStatus = async (taskId) => {
  const response = await fetch(`{{ request.url_root }}api/tasks/${taskId}`, {
    headers: { 'X-API-Key': 'sua-chave-aqui' }
  });
  
  const data = await response.json();
  console.log('Status:', data);
  
  if (data.status === 'processing') {
    setTimeout(() => checkTaskStatus(taskId), 3000);
  }
};

// Exemplo de uso
downloadMedia('https://youtube.com/watch?v=dQw4w9WgXcQ', 'audio', { bitrate: '320k' });</code></pre>
                                </div>
                            </div>

                            <!-- Python Examples -->
                            <div>
                                <h3 class="text-xl font-semibold text-cyan-300 mb-4">Python (requests)</h3>
                                <div class="code-block">
                                    <pre><code class="language-python">import requests
import time

class MediaAPI:
    def __init__(self, api_key, base_url="{{ request.url_root }}"):
        self.api_key = api_key
        self.base_url = base_url
        self.headers = {'X-API-Key': api_key}
    
    def download_media(self, url, media_type, **kwargs):
        params = {'type': media_type, 'url': url, **kwargs}
        
        response = requests.get(
            f"{self.base_url}api/media",
            params=params,
            headers=self.headers
        )
        
        data = response.json()
        
        if data.get('status') == 'completed' or data.get('status', {}).get('task') == 'completed':
            return data.get('status', {}).get('download_url') or data.get('result', {}).get('download_url')
        elif data.get('status') == 'processing':
            return self.wait_for_completion(data['task_id'])
        else:
            raise Exception(f"Erro: {data.get('error', 'Desconhecido')}")
    
    def wait_for_completion(self, task_id):
        while True:
            response = requests.get(
                f"{self.base_url}api/tasks/{task_id}",
                headers=self.headers
            )
            data = response.json()
            
            print(f"Status: {data.get('status')} - {data.get('message', '')}")
            
            if data.get('status') == 'completed':
                return data.get('result', {}).get('download_url')
            elif data.get('status') == 'failed':
                raise Exception(f"Tarefa falhou: {data.get('message')}")
            
            time.sleep(3)

# Exemplo de uso
api = MediaAPI('sua-chave-aqui')
download_url = api.download_media(
    'https://youtube.com/watch?v=dQw4w9WgXcQ',
    'audio',
    bitrate='320k'
)
print(f"Download disponível em: {download_url}")</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Supported Sites Section -->
                <section id="supported-sites" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-globe mr-3 text-cyan-400"></i>Sites Suportados
                        </h2>
                        
                        <div class="mb-6">
                            <p class="text-gray-400 mb-4">Nossa API suporta mais de <span class="text-cyan-400 font-bold">1000 sites</span> diferentes para download de mídia. Aqui estão os principais:</p>
                        </div>

                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                            <div class="site-category">
                                <h3 class="text-lg font-semibold text-red-400 mb-3">
                                    <i class="fab fa-youtube mr-2"></i>Vídeo
                                </h3>
                                <ul class="space-y-1 text-sm text-gray-300">
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>YouTube</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Vimeo</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Dailymotion</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Twitch</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Facebook</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Instagram</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>TikTok</li>
                                </ul>
                            </div>

                            <div class="site-category">
                                <h3 class="text-lg font-semibold text-purple-400 mb-3">
                                    <i class="fas fa-music mr-2"></i>Áudio
                                </h3>
                                <ul class="space-y-1 text-sm text-gray-300">
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>SoundCloud</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Bandcamp</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Mixcloud</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>AudioMack</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>YouTube Music</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Spotify (Podcasts)</li>
                                </ul>
                            </div>

                            <div class="site-category">
                                <h3 class="text-lg font-semibold text-blue-400 mb-3">
                                    <i class="fas fa-broadcast-tower mr-2"></i>Streaming
                                </h3>
                                <ul class="space-y-1 text-sm text-gray-300">
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Twitch Clips</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Reddit Videos</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Twitter Videos</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>LinkedIn Videos</li>
                                    <li><i class="fas fa-check text-green-400 mr-2"></i>Pinterest Videos</li>
                                </ul>
                            </div>
                        </div>

                        <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-6">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-info-circle text-blue-400 mr-2"></i>
                                <span class="font-semibold text-blue-300">Lista Completa</span>
                            </div>
                            <p class="text-gray-300 mb-4">
                                Para ver a lista completa de todos os sites suportados, faça uma requisição para:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-bash">curl {{ request.url_root }}api/supported-sites</code></pre>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Error Codes Section -->
                <section id="errors" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-exclamation-triangle mr-3 text-cyan-400"></i>Códigos de Erro
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="error-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="status-badge status-400">400 Bad Request</span>
                                    <span class="text-sm text-gray-400">Dados de entrada inválidos</span>
                                </div>
                                <p class="text-gray-300 mb-2">Parâmetros obrigatórios ausentes ou formato inválido.</p>
                                <div class="code-block">
                                    <pre><code class="language-json">{
  "error": "Dados de entrada inválidos",
  "details": [
    {
      "field": "url",
      "message": "URL é obrigatória"
    }
  ]
}</code></pre>
                                </div>
                            </div>
                            
                            <div class="error-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="status-badge status-401">401 Unauthorized</span>
                                    <span class="text-sm text-gray-400">Chave de API inválida</span>
                                </div>
                                <p class="text-gray-300 mb-2">API Key não fornecida ou inválida no header X-API-Key.</p>
                                <div class="code-block">
                                    <pre><code class="language-json">{
  "error": "Chave de API inválida ou não fornecida. Use o header X-API-Key."
}</code></pre>
                                </div>
                            </div>

                            <div class="error-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="status-badge status-429">429 Too Many Requests</span>
                                    <span class="text-sm text-gray-400">Rate limit excedido</span>
                                </div>
                                <p class="text-gray-300 mb-2">Muitas requisições em pouco tempo. Aguarde antes de tentar novamente.</p>
                                <div class="code-block">
                                    <pre><code class="language-json">{
  "error": "Rate limit excedido",
  "retry_after": 60,
  "limit": "20 per minute"
}</code></pre>
                                </div>
                            </div>
                            
                            <div class="error-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="status-badge status-500">500 Internal Server Error</span>
                                    <span class="text-sm text-gray-400">Erro interno do servidor</span>
                                </div>
                                <p class="text-gray-300 mb-2">Erro durante o processamento da mídia ou falha no sistema.</p>
                                <div class="code-block">
                                    <pre><code class="language-json">{
  "error": "Erro interno do servidor",
  "message": "Falha no processamento do vídeo",
  "support": "Entre em contato com o suporte"
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SDKs Section -->
                <section id="sdks" class="section">
                    <div class="glass-effect rounded-xl p-8 endpoint-card">
                        <h2 class="text-3xl font-bold text-white mb-6">
                            <i class="fas fa-cube mr-3 text-cyan-400"></i>SDKs & Bibliotecas
                        </h2>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <div class="sdk-card">
                                <div class="flex items-center mb-4">
                                    <i class="fab fa-js-square text-3xl text-yellow-400 mr-3"></i>
                                    <div>
                                        <h3 class="text-lg font-semibold text-white">JavaScript/Node.js</h3>
                                        <p class="text-sm text-gray-400">SDK oficial com TypeScript</p>
                                    </div>
                                </div>
                                <div class="code-block mb-4">
                                    <pre><code class="language-bash">npm install @ytdl-api/sdk</code></pre>
                                </div>
                                <div class="code-block">
                                    <pre><code class="language-javascript">import { YTDLClient } from '@ytdl-api/sdk';

const client = new YTDLClient('sua-api-key');
const result = await client.download('https://youtube.com/watch?v=...', {
  type: 'audio',
  bitrate: '320k'
});</code></pre>
                                </div>
                            </div>
                            
                            <div class="sdk-card">
                                <div class="flex items-center mb-4">
                                    <i class="fab fa-python text-3xl text-blue-400 mr-3"></i>
                                    <div>
                                        <h3 class="text-lg font-semibold text-white">Python</h3>
                                        <p class="text-sm text-gray-400">Biblioteca com async/await</p>
                                    </div>
                                </div>
                                <div class="code-block mb-4">
                                    <pre><code class="language-bash">pip install ytdl-api-python</code></pre>
                                </div>
                                <div class="code-block">
                                    <pre><code class="language-python">from ytdl_api import YTDLClient

client = YTDLClient('sua-api-key')
result = client.download('https://youtube.com/watch?v=...', 
                        media_type='audio', bitrate='320k')</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-6">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-info-circle text-blue-400 mr-2"></i>
                                <span class="font-semibold text-blue-300">Contribuições</span>
                            </div>
                            <p class="text-gray-300">
                                Interessado em criar um SDK para sua linguagem favorita? 
                                <a href="mailto:dev@example.com" class="text-cyan-400 hover:underline">Entre em contato</a> 
                                ou contribua no nosso 
                                <a href="#" class="text-cyan-400 hover:underline">repositório GitHub</a>.
                            </p>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-16 border-t border-gray-700/50 bg-gray-900/50">
        <div class="container mx-auto px-8 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-3 mb-4 md:mb-0">
                    <div class="w-8 h-8 bg-gradient-to-r from-cyan-600 to-cyan-700 rounded-lg flex items-center justify-center">
                        {% if app_settings and app_settings.app_logo %}
                            <img src="{{ app_settings.app_logo }}" alt="Logo" class="w-6 h-6 rounded">
                        {% else %}
                            <i class="fas fa-download text-white text-sm"></i>
                        {% endif %}
                    </div>
                    <span class="text-gray-400">{{ app_settings.footer_text if app_settings else '© 2024 YTDL Web API. Todos os direitos reservados.' }}</span>
                </div>
                <div class="flex items-center space-x-6 text-gray-500">
                    <a href="/api/health" class="hover:text-cyan-400 transition-colors">
                        <i class="fas fa-heartbeat mr-1"></i>Status
                    </a>
                    <a href="{{ url_for('auth.login') }}" class="hover:text-cyan-400 transition-colors">
                        <i class="fas fa-cog mr-1"></i>Admin
                    </a>
                    <span class="text-xs">v2.0</span>
                </div>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/docs/navigation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/docs/public-download.js') }}"></script>
    <script src="{{ url_for('static', filename='js/docs/code-copy.js') }}"></script>
</body>
</html>